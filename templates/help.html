{% extends 'base.html' %}
{% block content %}
<div class="hero p-3 rounded-4 mb-3">
  <div class="d-flex justify-content-between align-items-center">
    <div>
      <p class="text-secondary mb-1">Yardım</p>
      <h2 class="mb-0">SSS (Sık Sorulan Sorular)</h2>
    </div>
    <div class="text-end">
      <a class="btn btn-outline-secondary btn-sm" href="/dashboard">Dashboard</a>
    </div>
  </div>
</div>

<div class="card mb-3"><div class="card-body">
  <h6 class="mb-1">Kısa Özet</h6>
  <div class="small text-secondary">
    Bu panel; sensör okumalarını izler, güvenli manuel kontrol sağlar, otomasyon ayarlarını yönetir ve kayıt (log) tutar.
    Soruların çoğu aşağıdaki başlıklarda cevaplı.
  </div>
</div></div>

<div class="accordion" id="faqAccordion">
  <div class="accordion-item">
    <h2 class="accordion-header" id="hGenel">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#cGenel" aria-expanded="true" aria-controls="cGenel">
        Genel
      </button>
    </h2>
    <div id="cGenel" class="accordion-collapse collapse show" aria-labelledby="hGenel" data-bs-parent="#faqAccordion">
      <div class="accordion-body small">
        <p class="mb-2"><strong>Bu panel ne yapar?</strong><br>Dashboard anlık sensörleri ve özetleri gösterir. Kontrol sayfası röleleri güvenli şekilde aç/kapatır. Ayarlar sayfası SAFE MODE/limit/otomasyon ayarlarını yönetir. Pin Mapping, kanal→GPIO eşleşmesini düzenler. Loglar sayfası kayıtlı sensör ölçümlerini listeler ve CSV indirir.</p>
        <p class="mb-0"><strong>“SIM / OK / HATA / YOK” ne demek?</strong><br><span class="pill">OK</span> gerçek okuma, <span class="pill">SIM</span> simülasyon/kitaplık yok, <span class="pill">HATA</span> okuma hatası, <span class="pill">YOK</span> sensör bulunamadı veya erişilemiyor.</p>
      </div>
    </div>
  </div>

  <div class="accordion-item">
    <h2 class="accordion-header" id="hDashboard">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#cDashboard" aria-expanded="false" aria-controls="cDashboard">
        Dashboard (İzleme)
      </button>
    </h2>
    <div id="cDashboard" class="accordion-collapse collapse" aria-labelledby="hDashboard" data-bs-parent="#faqAccordion">
      <div class="accordion-body small">
        <p class="mb-2"><strong>Veri gecikmesi / stale nedir?</strong><br>Üst barda “Veri gecikmesi” son sensör okumasının kaç saniye önce alındığını gösterir. Gecikme <code>SENSOR_STALE_SECONDS</code> üstüne çıkarsa “stale” sayılır ve güvenlik mantıkları devreye girebilir.</p>
        <p class="mb-2"><strong>Grafikler neyi gösterir?</strong><br>Grafikler, sensör logundan seçtiğin metrik için (son 24 saat / 7 gün) zaman serisini gösterir. “CSV” linki aynı veriyi dışa aktarır.</p>
        <p class="mb-0"><strong>Olay Günlüğü nedir?</strong><br>Sistemin önemli olaylarını (aktüatör komutları, uyarılar, otomasyon sebepleri vb.) listeler.</p>
      </div>
    </div>
  </div>

  <div class="accordion-item">
    <h2 class="accordion-header" id="hKontrol">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#cKontrol" aria-expanded="false" aria-controls="cKontrol">
        Kontrol (Manuel Röle)
      </button>
    </h2>
    <div id="cKontrol" class="accordion-collapse collapse" aria-labelledby="hKontrol" data-bs-parent="#faqAccordion">
      <div class="accordion-body small">
        <p class="mb-2"><strong>Acil Durdur ne yapar?</strong><br>Tüm kanalları güvenli şekilde OFF yapar ve zamanlayıcıları iptal eder.</p>
        <p class="mb-2"><strong>Pompa neden süreli?</strong><br>Güvenlik için pompa komutları süreli çalışır. Ayrıca “cooldown” ile arka arkaya çalıştırma sınırlandırılır.</p>
        <p class="mb-0"><strong>SAFE MODE açıkken kontrol neden çalışmıyor?</strong><br>SAFE MODE açıkken sistem sadece izleme modundadır; röle/aktüatör komutları kilitlidir.</p>
      </div>
    </div>
  </div>

  <div class="accordion-item">
    <h2 class="accordion-header" id="hAyarlar">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#cAyarlar" aria-expanded="false" aria-controls="cAyarlar">
        Ayarlar (SAFE MODE, Limitler, Otomasyon)
      </button>
    </h2>
    <div id="cAyarlar" class="accordion-collapse collapse" aria-labelledby="hAyarlar" data-bs-parent="#faqAccordion">
      <div class="accordion-body small">
        <p class="mb-2"><strong>Admin Token nedir?</strong><br><code>ADMIN_TOKEN</code> ortam değişkeni tanımlıysa, admin işlemleri için tarayıcıdan token girmen gerekir. Token yoksa admin işlemleri sadece yerel ağdan (LAN) kabul edilir.</p>
        <p class="mb-2"><strong>Limitler ne işe yarar?</strong><br>Pompa/ısıtıcı gibi riskli çıkışlara süre ve soğuma (cooldown) sınırı koyar. Isıtıcı için ayrıca “üst limit” sıcaklıkta otomatik kesme uygulanır.</p>
        <p class="mb-0"><strong>Otomasyon nasıl çalışır?</strong><br>Lux/ısıtıcı/pompa otomasyonları, pencere saatleri, hedef süreler ve “override/blok/min kapalı” kurallarıyla çalışır. Detaylar Dashboard’daki “Otomasyon Durumu” özetinde görülür.</p>
      </div>
    </div>
  </div>

  <div class="accordion-item">
    <h2 class="accordion-header" id="hPin">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#cPin" aria-expanded="false" aria-controls="cPin">
        Pin Mapping (GPIO & Röle Kanalları)
      </button>
    </h2>
    <div id="cPin" class="accordion-collapse collapse" aria-labelledby="hPin" data-bs-parent="#faqAccordion">
      <div class="accordion-body small">
        <p class="mb-2"><strong>Active Low nedir?</strong><br>Active-low rölede “0” seviyesi röleyi çeker (ON), “1” seviyesi bırakır (OFF). Yanlış seçilirse röle ters çalışır.</p>
        <p class="mb-0"><strong>Neden kaydederken her şey OFF oluyor?</strong><br>Güvenlik için mapping değişince tüm kanallar OFF yapılır.</p>
      </div>
    </div>
  </div>

  <div class="accordion-item">
    <h2 class="accordion-header" id="hLoglar">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#cLoglar" aria-expanded="false" aria-controls="cLoglar">
        Loglar (Sensör Kayıtları)
      </button>
    </h2>
    <div id="cLoglar" class="accordion-collapse collapse" aria-labelledby="hLoglar" data-bs-parent="#faqAccordion">
      <div class="accordion-body small">
        <p class="mb-2"><strong>Loglar nerede tutuluyor?</strong><br>İki yerde: (1) SQLite: <code>data/sera.db</code> tablosu <code>sensor_log</code> (2) Günlük CSV: <code>data/sensor_logs/sensor_log_YYYY-MM-DD.csv</code></p>
        <p class="mb-2"><strong>CSV indir ne indirir?</strong><br>Seçtiğin zaman aralığına göre SQLite’daki satırları CSV olarak indirir.</p>
        <p class="mb-0"><strong>Log temizle ne yapar?</strong><br>Admin yetkisiyle SQLite’daki sensör logunu temizler (tamamı veya “Başlangıç” alanına yazılan tarihten önce). CSV dosyaları silinmez.</p>
      </div>
    </div>
  </div>

  <div class="accordion-item">
    <h2 class="accordion-header" id="hSorun">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#cSorun" aria-expanded="false" aria-controls="cSorun">
        Sorun Giderme
      </button>
    </h2>
    <div id="cSorun" class="accordion-collapse collapse" aria-labelledby="hSorun" data-bs-parent="#faqAccordion">
      <div class="accordion-body small">
        <p class="mb-2"><strong>Dashboard’da sensörler “YOK/HATA” görünüyor</strong><br>I2C/1-Wire etkin mi, kütüphaneler kurulu mu, pin/addr doğru mu kontrol et. Simülasyon modunda <span class="pill">SIM</span> görünmesi normaldir.</p>
        <p class="mb-2"><strong>Röleler ters çalışıyor</strong><br>Pin Mapping’de ilgili kanal için <em>Active Low</em> kutusunu kontrol et.</p>
        <p class="mb-0"><strong>Loglar boş</strong><br>Sensörlerin durumunun <span class="pill">OK</span> veya <span class="pill">SIM</span> olması gerekir; ayrıca log interval nedeniyle birkaç saniye gecikmeli yazılabilir.</p>
      </div>
    </div>
  </div>
</div>

{% endblock %}

